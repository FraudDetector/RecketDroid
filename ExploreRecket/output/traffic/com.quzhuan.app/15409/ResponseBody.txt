/*
 * Copyright (C) 2017, hapjs.org. All rights reserved.
 */
!function(){"use strict";var o=navigator.userAgent.toLowerCase();function a(e,n){for(var t in n=n||{})e[t]=n[t];return e}function d(e,n,t){var o=document.createElement("iframe"),e="hwfastapp://"+e;n&&(e=e+"/"+n),t&&0<Object.keys(t).length&&(e=e+"?"+(t=Object.keys(t).map(function(e){return e+"="+encodeURIComponent(t[e])}).join("&"))),o.src=e,document.body.appendChild(o),o.style.display="none"}function e(e){var n={available:new Function};"function"==typeof e?n.available=e:"object"==typeof e&&a(n,e);var t=!1,o=n.available;n.available=function(){t||(t=!0,o.apply(null,arguments))},n.available.call(null,!0)}function n(e,n,t){var o,a,i,r,c,u;!function(){var e=navigator.userAgent;if(e){if(0<=(e=e.toLowerCase()).indexOf("huaweibrowser"))return;var n=e.indexOf("android"),t=e.indexOf("huawei");if(t<0&&(t=e.indexOf("honor")),0<=n&&0<=t){t=e.slice(n+8,n+9);if(8<=t)return 1;if((t=e.slice(n+8,n+10))&&t.indexOf(";")<0&&10<=t)return 1}}}()?d(e,n,t):(o=e,a=n,i=t=t||{},r="",c=(c="http://fastappjump-drcn.hispace.dbankcloud.cn/fastapprouter/")+(new Date).getTime()+"/",a&&0===a.indexOf("/")&&(a=1===a.length?"":a.substr(1)),o&&(c=c+"?i="+o),a&&(c=c+"&p="+a),function(){if(!i)return 1;var e=void 0;for(e in i)return;return 1}()?-1<(a=window.location.search).indexOf("?")&&(r=a.substr(1)):r=Object.keys(i).map(function(e){return e+"="+encodeURIComponent(i[e])}).join("&"),""!==r&&(c=c+"&a="+encodeURIComponent(r)),(r=document.createElement("img")).src=c,r.style.width="1px",r.style.height="1px",r.style.display="none",document.body.appendChild(r),function(){var e=navigator.userAgent;if(e){var n=(e=e.toLowerCase()).indexOf("android"),t=e.indexOf("huawei");if(t<0&&(t=e.indexOf("honor")),0<=n&&0<=t){t=e.slice(n+8,n+9);if(9<=t)return;if((t=e.slice(n+8,n+10))&&t.indexOf(";")<0&&10<=t)return}}return 1}()&&(u=new Date,setTimeout(function(){new Date-u<=830&&d(e,n,t)},800)))}var i="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto),r=new Uint8Array(16);var t=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;for(var c=[],u=0;u<256;++u)c.push((u+256).toString(16).substr(1));function l(e,n){n=1<arguments.length&&void 0!==n?n:0,e=(c[e[n+0]]+c[e[n+1]]+c[e[n+2]]+c[e[n+3]]+"-"+c[e[n+4]]+c[e[n+5]]+"-"+c[e[n+6]]+c[e[n+7]]+"-"+c[e[n+8]]+c[e[n+9]]+"-"+c[e[n+10]]+c[e[n+11]]+c[e[n+12]]+c[e[n+13]]+c[e[n+14]]+c[e[n+15]]).toLowerCase();if("string"!=typeof(n=e)||!t.test(n))throw TypeError("Stringified UUID is invalid");return e}function s(e,n,t){var o=(e=e||{}).random||(e.rng||function(){if(!i)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return i(r)})();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,n){t=t||0;for(var a=0;a<16;++a)n[t+a]=o[a];return n}return l(o)}function f(e){e=+(e.match(/.*Android (\d+).*/i)||[])[1];return!isNaN(e)&&e<10}function p(e){e=+(e.match(/.*Android (\d+).*/i)||[])[1];return!isNaN(e)&&10<=e}function m(e){return 1<(e.match(/.*(iPhone|iPad|Mac OS).*/i)||[]).length}function h(e){return 1<(e.match(/.*(xiaomi|redmi|mix|mi\s).*/i)||[]).length}function v(e){return 0<(e.match(/(?:vivo|iqoo|v\d{4}(a|t|ba|ca|bt|ct|et|ea|ga) build)/i)||[]).length}function g(e,n,t,o){var a=e,i="";n&&(a=a+"?i="+n),t&&(a=a+"&p="+t),a+="&random="+Math.random(),!function(e){if(!e)return 1;var n=void 0;for(n in e)return;return 1}(o)?i=Object.keys(o).map(function(e){return e+"="+encodeURIComponent(o[e])}).join("&"):-1<(e=window.location.search).indexOf("?")&&(i=e.substr(1));t=navigator.userAgent;(v(t=t.toLowerCase())||h(t)||0<(t.match(/.* (oppo|oneplus|p[a-z]{3}\d{2}|(rmx|cph|n|gm|hd|in|le|mw)\d{4}|a\d{2,4}[a-z]{0,2}|(r|u|x)\d{3,4}[a-z]{0,1}) .*/i)||[]).length)&&(t=(e=function(){var n="",t=!0;try{n=top.location.href}catch(e){try{var o=window.location.ancestorOrigins;n=o[o.length-1]}catch(e){n=document.referrer,t=!1}}return{url:n,isTopUrl:t}}()).url,e=e.isTopUrl,i=(i=i+"&url_origin_top="+encodeURIComponent(t))+"&url_is_top="+encodeURIComponent(e)),""!==i&&(a=a+"&a="+encodeURIComponent(i));i=document.createElement("img");i.src=a,i.style.width="1px",i.style.height="1px",i.style.display="none",document.body.appendChild(i)}function y(e,n){var t,o=document.createElement("img");o.style.width="1px",o.style.height="1px",o.style.display="none",e+="/"+1e20*Math.random(),o.src=e,document.body.appendChild(o),n=a({availableTimeout:2e3},n),o.complete?n.available.call(null,!0):(o.onload=function(){clearTimeout(t),n.available.call(null,!0)},t=setTimeout(function(){n.available.call(null,!1)},n.availableTimeout))}var b=navigator.userAgent,w="http://thefatherofsalmon.com",x="http://v2.thefatherofsalmon.com";function O(e,n,t){h(b)&&(t.__xiaomi_session__=s()),m(b)?console.debug("Detect device: Apple device;"):f(b)?(console.debug("Detect device: Below Android Q;"),g(w,e,n,t),h(b)&&g(x,e,n,t)):(p(b)?(console.debug("Detect device: Greater and equal than Android Q;"),v(b)||g(w,e,n,t)):(console.debug("Detect device: None match;"),g(w,e,n,t)),g(x,e,n,t))}function C(e,n,t,o){return t=t||{},o&&(t.__PROMPT__=1,t.__NAME__=o),O(e,n,t)}function R(e,n){return O("command","",{type:"shortcut",package:e,name:n})}function _(e){var n={available:new Function};"function"==typeof e?n.available=e:"object"==typeof e&&a(n,e);var t=!1,o=n.available;return n.available=function(){t||(t=!0,o.apply(null,arguments))},n=n,void(m(b)?(console.debug("Detect device: Apple device;"),n.available.call(null,!1)):f(b)?(console.debug("Detect device: Below Android Q;"),y(w+"/images",n)):(p(b)?(console.debug("Detect device: Greater and equal than Android Q;"),v(b)||y(w+"/images",n)):(console.debug("Detect device: None match;"),y(w+"/images",n)),y(x+"/images",n)))}v(b)&&(w="http://thefatherofsalmon.com",x="http://v2.thefatherofsalmon.com"),!function(e){void 0===e&&(e=o);var n=e.indexOf("android"),t=e.indexOf("huawei"),e=e.indexOf("honor");return 0<=n&&(0<=t||0<=e)}()?(window.appRouter=C,window.installShortcut=R,window.channelReady=_):(window.appRouter=window.appRouterHw=n,window.channelReady=e)}();
